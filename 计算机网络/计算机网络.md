# 第1章 计算机网络

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-02-26_145221.png)

- 网络是由若干节点和连接这些节点的链路构成，表示诸多对象及其相互联系。

- 计算机网络通俗地讲就是通过传输介质将分布在各个地方的计算机和网络设备连接起来，实现数据通信、资源共享的一张网络。

- 计算机网络主要包括三部分：
  - 计算机 （可以包括客户端、服务器）
  - 网络设备 （路由器、交换机、防火墙等）
  - 传输介质（可以分为有线和无线的）

## 局域网

- 企业、组织，公司内部自行组建的网络，其所有设备归组织所有，其目的是实现内部用户的办公需求
- 小范围内的私有网络，一个家庭内的网络、一个公司内的网络、一个校园内的网络都属于局域网。

## 广域网

- 通过向运营商购买不同的广域网连接（带宽、费用），目的是让一家公司能够通过广域网访问远程用户，分公司、以及合作伙伴。
- 把不同地域的局域网互相连接起来的网络。运营商搭建连接远距离区域的广域网。

## 互联网

- 由世界各地的局域网和广域网连接起来的网络。互联网是一个开放、互联的网络，不属于任何个人和任何机构。

## 服务器

- 是指网络中能对其它机器提供某些服务的计算机系统（如果一个PC对服务器端外提供ftp服务，也可以叫服务器）。

## 客户机

- 是指与服务器相对应，为客户提供本地服务的程序。

## OSI参考模型解析

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\屏幕截图 2024-02-19 144952.png)

### 应用层

- 是OSI模型中的最高层，是人机交互的窗口，通过应用层把人的语言输入到计算机当中去，为网络用户之间的通信提供专用的程序服务。

### 表示层

- 负责将接收到的数据翻译成二进制数组成的计算机语言，主要通过数据格式变化、数据加密与解密、数据压缩与解压等。

### 会话层

- 会话层用于建立、管理、中止会话。会话层的主要功能是负责维护两个节点之间的传输联接，确保点到点传输不中断，以及管理数据交换等功能。会话层还可以通过对话控制来决定使用何种通信方式，全双工通信或半双工通信。

网络会话查看

> netstat -n
>
> netstat -nb

微软配置工具

> msconfig

### 传输层

- 将一个数据/文件斩件分成很多小段，标记顺序以被对端接收后可以按顺序重组数据，另外标记该应用程序使用的端口号及提供QOS。传输层起到了承上启下的作用，承接上层软件应用，下启网络数据传输。

> 可靠传输 建立会话 流量控制 差错检查

> 不可靠传输 不建立会话 节省服务器资源

### 网络层

- 传输的基本单位为“**数据包**”，提供IP地址，负责把数据包从源网络传输到目标网络的路由选择工作。
- P协议是网络层中的核心协议。IP协议非常简单，仅仅提供不可靠、无连接的传送服务。

> 选择最佳路径到达目的地址
>
> 路由选路，选择本次通信使用的协议（http、ftp等），指定路由策略及访问控制策略。（IP地址在这一层）

### 数据链路层

- 传输的基本单位为“**帧**”，将比特组合成字节，再将字节组合成帧，使用**链路层地址（以太网使用MAC地址）**来访问介质，并为网络层提供**差错控制**和**流量控制**服务。
- 由**MAC(介质访问控制子层)**和**LLC(逻辑链路控制子层)**组成。
  - 介质访问控制子层的主要任务是规定如何在物理线路上传输帧。（和物理层相连）
  - 数据链路控制子层主要负责逻辑上识别不同协议类型，并对其进行封装。也就是说数据链路控制子层会接受网络协议数据、分组的数据报并且添加更多的控制信息，从而把这个分组传送到它的目标设备。（和网络层对接）

> 网络设备 如何封装数据帧 设备地址MAC
>
> 根据端口与MAC地址，做分组（VLAN）隔离、端口安全、访问控制。（MAC地址在这一层）处理VLAN内的数据帧转发，跨VLAN间的访问，需要上升到网络层。

### 物理层

- 主要定义了系统的**电气、机械、过程和功能标准**。如：电压、物理数据速率、最大传输距离、物理联接器和其他的类似特性。

- **物理层传输的基本单位是比特流，即0和1**，也就是最基本的电信号或光信号，是最基本的物理传输特征。。

  > 比特流与电子信号之间的切换

### **数据封装/解封装**

> PC1和PC2需要进行数据通信？那么PC1发送给PC2的数据包需要根据OSI参考模型至上而下进行数据封装，PC2收到数据包至下而上进行解封装。
>
> 概念可以使用寄快递和取快递类比，中间的**传输介质**就是物流公司。

### 总结

- **OSI模型每层都有自己的功能集**

- **层与层之间相互独立又相互依靠**

- **上层依赖于下层，下层为上层提供服务**

## 传输介质

- 网络传输介质是指在网络中**传输信息的载体**，常用的传输介质分为**有线传输介质**和**无线传输介质**两大类。
  - 有线
    - 同轴电缆（基本淘汰）
    - 双绞线（电信号）
      - 屏蔽双绞线(STP)和非屏蔽双绞线(UTP)。屏蔽双绞线在双绞线与外层绝缘封套之间有一个金属屏蔽层，可以屏蔽电磁干扰。
      - 3类双绞线支持10Mbps传输速率；5类双绞线支持100Mbps传输速率，满足快速以太网标准；超5类双绞线及更高级别的双绞线支持千兆以太网传输。
    - 光纤（光信号）
      - 光纤是由纯石英玻璃制成的。纤芯外面包围着一层折射率比芯纤低的包层，包层外是一塑料护套。
      - **单模光纤**只能传输一种模式的光，不存在模间色散，因此适用于**长距离高速传输**。（黄色为单模光纤）
      - **多模光纤**允许不同模式的光在一根光纤上传输，由于模间色散较大而导致信号脉冲展宽严重，因此**多模光纤主要用于局域网中的短距离传输**。（橙色为多模光纤。）
  - 无线
    - 微波传输
    - 红外线
    - 激光传输

- 不同的传输介质具有不同的特性，这些特性直接影响到通信的诸多方面，如**线路编码方式、传输速度和传输距离**

## 网络排错和OSI参考模型

> 排错从底层到高层顺序

物理层：连接问题

数据链路层：MAC地址冲突、ADSL拨号密码错误

网络层：计算机网关设置错误、路由器路由表错误

应用层：IE代理设置错误

## 网络安全

物理层安全：设备被盗、设备老化、意外故障、无线电磁辐射泄密等。如果局域网采用广播方式，那么本广播域中的所有信息都可以被侦听。

数据链路层安全：MAC地址认证、ADSL拨号上网账号密码、划分VLAN

- (1)数据机密性。防止在数据交换过程中数据被非法窃听。
- (2)数据完整性。防止在数据交换过程中数据被非法篡改。

网络层安全：路由器ACL

传输层安全：端口安全

应用层安全：网站安全、操作系统安全

## 网络设备

网线：双绞线 8根 100米 10M 100M 1000M

​           线序 直通线

> 同类设备->交叉线
>
> 不同设备->直通线

网卡：MAC 物理地址 硬件地址（不能更改）

查看mac地址 ipconfig /all

集线器：HUB 安全 带宽共享 半双工通信。（冲突域）

> 是指将多条以太网双绞线或光纤集合连接在同一段物理介质下的设备。工作于物理层，它会把收到的任何数字信号，经过再生或放大，再从集线器的所有端口提交，这会造成信号之间碰撞的机会很大，而且信号也可能被窃听，并且这代表所有连到集线器的设备，都是属于同一个碰撞域名以及广播域名。

网桥：工作于数据链路层，不但能扩展网络的距离或范围，而且可提高网络的性能、可靠性和安全性。（交换机取代）

交换机：基于MAC地址转发数据 安全 带宽独享 全双工通信。（广播域）

> 交换机工作于OSI参考模型的第二层，即数据链路层。交换机内部的CPU会在每个端口成功连接时，通过将MAC地址和端口对应，形成一张MAC表。在今后的通讯中，发往该MAC地址的数据包将仅送往其对应的端口，而不是所有的端口。因此，交换机可用于划分数据链路层广播，即冲突域；但它不能划分网络层广播，即广播域。

路由器：负责在不同网段转发数据 一般有广域网接口 隔绝广播 目标MAC地址全1.

## 网络设备和OSI参考模型

- 集线器 物理层设备

- 交换机基础MAC转发 数据链路层设备
- 路由器 基于IP地址转发 三层设备

## 分层考虑问题

- 网络排错方法 替换法

# 第2章 TCP/IP协议

## 应用层协议

### 常见默认端口

- http=TCP+80
- ftp=TCP+21（上传、下载） 20（传输）
- https=TCP+443
- SMTP=TCP+25（邮件发送协议）
- POP3=TCP+110（邮件读取协议）
- RDP=TCP+3389（远程桌面）
- DNS=UDP（TCP）+53
- IP访问Window共享文件夹=TCP+445
- SQL=TCP+1433
- telent=TCP+23

### 服务和端口的关系

- 服务侦听端口

- 服务器根据数据包的目标端口来区分客户端请求的服务
- 服务停止 侦听的端口关闭

#### 查看侦听的端口

> netstat -anb 
>
> netstat -anb | find "3389" 

#### 查看默认端口和更改端口

> telnet 192.168.80.120 25

### 网络安全

- 在2003Server和XP上使用TCP/IP筛选实现网络安全（不拦截出口流量）
- WindowsXP WindowsServer2003防火墙（不拦截出口流量）
- WindowsXP WindowsServer2003支持IPSec严格控制进出计算机的流量

### 注意

- Windows防火墙依赖Windows Firewall服务 不如TCP/IP筛选安全

- Windows7防火墙 高级安全防火墙能够控制出入计算机的流量

  wf.msc

## 传输层的两个协议

- 可靠传输

  TCP（数据需要拆分传输时用，建立会话（消耗服务器资源）、丢失重传 netstat -n查看）

- 不可靠传输

  UDP（数据不需要拆分时用，一个数据包就能表达完整的意思，屏幕广播）

### **TCP协议**

**TCP是传输层协议**，用于**为应用层提供服务**，通过**端口号**可以**唯一标识一个应用。**

> 什么是TCP?

**TCP** 是**面向连接的,提供端到端可靠性服务**的传输层协议。

面向连接：

- 面向连接中通信中，会在在两个端点之间建立了一条可靠的数据通信信道。
- 电话就是一种面向连接的服务，双方建立连接后才能够通话，可以确保对方听到你说话；而发短信就不是一种面向连接的服务，你随时可以发送短信，但是不能确保对方及时收到。

端到端可靠:

- 保证从发送端发送的报文都可以被目的端收到，哪怕被丢弃，也可以让发送端重传;

> **为什么需要TCP,TCP可以解决什么问题?**

- IP 层是**不可靠的**，它只负责数据包的发送，但它不保证数据包能够被接收、不保证网络包的按序交付、也不保证网络包中的数据的完整性。
- 如果需要保障网络数据包的可靠性，那么就需要由上层（传输层）的 TCP 协议来负责。
- TCP 是一个工作在传输层的可靠数据传输的服务，它能确保接收端接收的网络包是无损坏、无间隔、非冗余和按序的。

### **UDP协议**

> **什么是UDP？**

UDP 是**User Datagram Protocol**的简称， 中文名是**用户数据报协**议，是OSI（Open System Interconnection，开放式系统互联） 参考模型中一种**无连接的传输层协议**，**传输可靠性没有保证**。

> **为什么需要UDP？**

- IP协议中并没有端口(port)的概念。IP协议进行的是IP地址到IP地址的传输。但每台计算机中需要有多个通信通道，并将多个通信通道分配给不同的进程使用。一个端口就代表了这样的一个通信通道。UDP协议实现了端口，从而让数据包可以在送到IP地址的基础上，进一步可以送到某个端口。
- 一些简单的通信，不需要复杂的建立TCP连接(特别是在早期网络环境中，过多的建立TCP连接，会造成很大的网络负担，而UDP协议可以相对快速的处理这些简单通信）
- 在使用TCP协议传输数据时，如果一个数据段丢失或者接收端对某个数据段没有确认，发送端会重新发送该数据段。TCP重新发送数据会带来传输延迟和重复数据，降低了用户的体验。对于迟延敏感的应用，少量的数据丢失一般可以被忽略，这时使用UDP传输将能够提升用户的体验。

## 网络层协议

### IP协议 

- 选择最佳路径的协议（RIP OSPF EIGRP BGP）

### ICMP协议 测试网络状态的协议

- ping 估算带宽 查看网络是否畅通 断定远程系统
- TTL 128 Windows系统
- TTL 64 Linux
- pathping 跟踪路径 计算丢包情况

> ping /? 查看命令选项

### IGMP 组播

- 点到点
- 广播
- 多播（组播，会议视频）

#### 1.单播 unicast:一对一

使用单播发送数据，有N台主机接受，我就要发送N次(接受者越多，发送的数据越多）

优点：能完全确保把数据发给需要的接受者，安全性高

缺点：发送数据的服务器压力大，带宽负载也大

#### 2.广播 broadcast ：一对all

使用广播，可以直接把信息发送给了所有的接受者

优点：同样的流量只需要发送一次，对链路的占用很小

缺点：压力主要集中在网络内的主机。不管我需不需要，都要接受到该数据

#### 3.组播 multicast :一对多（单播+广播）

优点：流量只需要发送一次，还能保证把流量发送给了需要的主机---安全性高

缺点：UDP（不可靠的）

### ARP **根据IP地址获取对方的MAC地址**

- 一台主机要发送数据给另一台主机时，必须要知道目的主机的网络层地址（即IP地址）。IP地址由网络层来提供，但是仅有IP地址是不够的。
- IP数据报文必须封装成帧才能通过数据链路进行发送。数据帧必须要包含目的MAC地址，因此发送端还必须获取到目的MAC地址。

1、ARP请求：
主机A首先会去检查ARP缓存表（ARP缓存用来存放IP地址和MAC地址的关联信息）中是否存在主机C的MAC地址。由于是第一次通信，主机A的ARP缓存表中没有主机C的MAC地址。这时主机A会发送ARP request报文（广播报文）来获取主机C的MAC地址。

2、ARP应答：
主机B收到主机A发送的ARP广播请求报文，查看目的IP不是自己会丢弃，但是会在自己的ARP缓存表中记录主机A的IP和MAC的映射关系，在主机B上通过命令arp -a 可以查询到。主机C发现目的IP是自己，会在自己的ARP缓存表中记录主机A的IP和MAC的映射关系，并会向主机A单播回应ARP Reply报文。主机A收到主机C的回应报文后后会在自己的ARP缓存表中记录主机C的IP和MAC的映射关系，下次发送数据就可以查询到主机C的MAC地址。

## 数据链路层

#### MAC地址

- **每一台网络设备都用物理地址来标识自己，**这个地址就是MAC地址。MAC地址也叫物理地址，大多数网卡厂商把MAC地址烧入了网卡的ROM中。
- 网络设备的MAC地址是全球唯一的。

**MAC地址组成**

1、前24比特是**组织唯一标识符，由IEEE统一分配给设备制造商**。

2、后24位序列号是**厂商分配给每个产品的唯一数值**，由各个厂商**自行分配**（这里所说的产品可以是网卡或者其他需要MAC地址的设备）。

**MAC地址作用**

**数据链路层基于MAC地址进行帧的传输。**发送端使用接收端的MAC地址作为目的地址发送数据帧。

## 计算机A和计算机B通信过程

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-02-27_155110.png)

数据跨网段通信和同网段通信的过程

- MAC地址决定下一跳给那个设备
- IP地址决定最终计算机

# 第3章 IP地址和子网划分

## IP地址

> **什么是IP地址**
>
> IP地址（Internet Protocol Address）是指互联网协议地址，又叫**网际协议地址**

- IP地址是IP协议（IP协议是为计算机网络相互连接进行通信而设计的协议）提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理MAC地址的差异。

> **IP地址作用**

- IP地址用来**标识网络中的设备**，具有IP地址的设备可以在同一网段内或跨网段通信

- **IP地址包括两部分**，第一部分是**网络号**，表示**IP地址所属的网段**，第二部分是**主机号**，用来**唯一标识本网段上的某台网络设备**。

> **IP地址表示**
> IPv4地址为32比特的二进制数，通常用点分十进制表示

- IP地址是一个**32位的二进制数**，通常被分割为4个“8位二进制数”（也就是4个字节）。

- IP地址通常用“**点分十进制**”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。

**二进制和十进制转换：**

| 比特位 | 1    | 1    | 1    | 1    | 1    | 1    | 1    | 1    |
| ------ | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 乘方   | 2^7  | 2^6  | 2^5  | 2^4  | 2^3  | 2^2  | 2^1  | 2^0  |
| 数值   | 128  | 64   | 32   | 16   | 8    | 4    | 2    | 1    |

例如：100=64+32+4=**2^6+2^5+2^2** ,那么100的二进制就是 **0110 0100 。**

> **IP地址分类**

 ![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-02-26_134334.png)

**A类，B类，和C类地址为可分配IP地址，每类地址支持的网络数和主机数不同。**

- **A类地址可支持126个网络**，每个网络支持2^24 （16,777,216 )个主机地址，另外每个网段中的网络地址和广播地址不能分配给主机。
- **C类地址支持200多万个网络**，每个网络支持256个主机地址，其中254个地址可以分配给主机使用。
- **D类地址为组播地址**。主机收到以D类地址为目的地址的报文后，且该主机是该组播组成员，就会接收并处理该报文。

**各类IP地址可以通过第一个字节中的比特位进行区分**。

- A类地址第一字节的最高位固定为0，B类地址第一字节的高两位固定为10，C类地址第一字节的高三位固定为110，D类地址第一字节的高四位固定为1110，E类地址第一字节的高四位固定为1111。

> **私有地址、特殊地址**

- IPv4中的部分IP地址被保留用作特殊用途
- 为节省IPv4地址，A， B， C类地址段中都预留了特定范围的地址作为**私网地址**。**主机分配私网地址节省了公网地址，可以用来缓解IP地址短缺的问题**。企业网络中普遍使用私网地址，不同企业网络中的私网地址可以重叠。默认情况下，网络中的主机无法使用私网地址与公网通信；当需要与公网通信时，私网地址必须转换成公网地址。

> **公有 IP 和私有 IP 的区别**

- 公有地址（Public address）：由 Inter NIC（Internet Network Information Center 因特网信息中心）负责。这些 IP 地址分配给注册并向Inter NIC提出申请的组织机构，公有 IP 全球唯一，通过它直接访问因特网（只能上网）。

- 私有地址（Private address）：属于非注册地址，专门为组织机构内部使用，说白了，私有 IP 不能直接上网。

**私有地址范围**

- A类 10.0.0.0~10.255.255.255
- B类 172.16.0.0~172.31.255.255
- C类 192.168.0.0~192.168.255.255

**特殊地址**

- 127.0.0.0 ~ 127.255.255.255

- 0.0.0.0

- 255.255.255.255

> 本地还回地址
>
> 127.0.0.1
>
> 169.254.0.0

疑惑：假如 A 和 B 的局域网 IP 相同（192.168.31.11），当他们同时访问百度服务器的时候，百度服务器如何区分哪个是 A，哪个是 B 呢？

**端口映射**

- 端口映射是 NAT 的一种，它将外网主机的 IP 地址的一个端口映射到内网中的一台机器，提供相应的服务。当用户访问该 IP 的这个端口时，服务器自动将请求映射到对应局域网内部的机器上。

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-02-26_142743.png)

- 内网外网之间的通讯过程，关键在于与服务器建立起映射，这样就能和服务器之间建立通信，请求数据。

**公网转局域网**

- A 的 IP 是局域网 IP（192.168.31.11），这个 IP（192.168.31.11）是从路由器的 lan口分配的。当我们上百度的时候，经过路由器的 wan口，进行相应的IP、端口转化：192.168.31.11:80 -> 10.221.0.24:8080,所以，从 wan口出去的地址为：10.221.0.24:8080。

> **子网掩码**

- 子网掩码用于区分网络部分和主机部分

  ![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_141618.png)

- 子网掩码与IP地址的表示方法相同。每个IP地址和子网掩码一起可以用来唯一的标识一个网段中的某台网络设备。子网掩码中的1表示网络位，0表示主机位。
  例如：子网掩码 255.128.0.0表示网络位为9位，主机位为23位。

- 默认子网掩码：
  每类IP地址有一个缺省子网掩码。
  A类地址的缺省子网掩码为8位，即第一个字节表示网络位，其他三个字节表示主机位。
  B类地址的缺省子网掩码为16位，因此B类地址支持更多的网络，但是主机数也相应减少。
  C类地址的缺省子网掩码为24位，支持的网络最多，同时也限制了单个网络中主机的数量。

## 子网划分

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_145748.png)

### 等分成2个子网

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_150718.png)

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_150931.png)

### 等分成4个子网

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_151648.png)

### 等分成8个子网

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_151828.png)

### 判断IP地址所属的网段

- 示例：判断192.168.0.101/27

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-01_152219.png)

### 变长子网划分

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-04_094209.png)

**CCNA考试题**

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-04_105010.png)

### 使用超网合并网络

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-04_110536.png)

- 合并后的网段子网掩码为：255.255.254.0，可用地址为192.168.1.254，IP地址的配置如图所示。

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-04_110905.png)

- 合并规律

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-04_111109.png)

![](E:\资料备份\Learning-Notes-for-Network-Engineers\计算机网络\img\2024-03-04_112057.png)

# 第四章 配置Cisco网络设备

## GNS3 搭建学习环境

https://gitcode.csdn.net/65ea828f1a836825ed7932b9.html?dp_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6NTU1NzU4LCJleHAiOjE3MTA3Mzg4NjgsImlhdCI6MTcxMDEzNDA2OCwidXNlcm5hbWUiOiJ3ZWl4aW5fNDU5NzcxOTgifQ.vWl6IxcupHBOSQz1evFrG7V2JAXjATIbaNj13E2QrqI

## 路由器接口

### **Serial口**

- 专为广域网设计，它可以做ISDN,PPP,帧中继等网络类型的连接可以接很多网络类型，要使用它必须设置时钟频率（DCE、DTE），路由表的算法也在此接口上形成。以太网口是对局域网内的，它只有拥有局域网所需要的所有功能。没有广域网接口所需要的功能，而广域网串口也没有局域网以太网口接口的功能，所以两个接口是不能对调的。

- 路由器连接路由器就要用路由器上的Serial端口连接，不过现在的路由器都没有这些，都用光口代替了。

### ethernet口

- 以太网口，现在可以说是百兆口，交换机间连在一起用的。

- 以太口（eth）是接RJ45水晶头的，串口（ser） 是远距离连接 使用的！可以是电缆也可以是光纤！

- 串口是串行口通讯协议，以太网口是以太网通讯协议。

### FastEthernet接口

- 快速以太网口

### Gigabit Ethernet接口

- 千兆网口









